import greenfoot.*;
import java.util.List;

public class UnionRifleman extends Actor
{
    private int HP = 100;
    private int dmg = 10;
    private int cost = 100;
    public int state = 0;
    private boolean isPlayer = true;
    public void act()
    {
        MouseInfo mi = Greenfoot.getMouseInfo();
        int oldX = getX();
        int oldY = getY();

        if(getX() < 6){
            setLocation(6, getY());
        }
        if(getX() > 14){
            setLocation(14, getY());
        }
        if(getY() < 2){
            setLocation(getX(), 2);
        }
        if(getY() > 11){
            setLocation(getX(), 11);
        }
        if(state == 0) {
            if(mi != null && Greenfoot.mouseClicked(this)) {
                state = 1;
                ((Battlefield)getWorld()).attackOrMove(this);
            }
            else if(mi != null && mi.getButton() == 3) {
                state = 2;
            }
        }
        else if(state == 1) {
            movement();
        }
        else if(state == 2) {
            attack();
        }

        Actor testEnemy = getOneObjectAtOffset(0, 0, EmpireRifleman.class);
        Actor testAlly = getOneObjectAtOffset(0, 0, UnionRifleman.class);
        if(testEnemy != null || testAlly != null){
            setLocation(oldX, oldY);
        }
    }

    public void movement() {
        if(!(Battlefield.getGameEnd())){
            MouseInfo mi = Greenfoot.getMouseInfo();
            int oldX = getX();
            int oldY = getY();
            if(Greenfoot.mouseClicked(null)) {
                setLocation(mi.getX(), mi.getY());
                if(getX() > oldX+1 || getX() < oldX-1 || getY() < oldY-1 || getY() > oldY+1) {
                    setLocation(oldX, oldY);
                }
                state = 0;
            }
        }
    }

    public void attack() {
        MouseInfo mi = Greenfoot.getMouseInfo();
        List<Actor> inRange = getObjectsInRange(2, null);
        if(mi != null && Greenfoot.mouseClicked(null)) {
            List<Actor> list = getWorld().getObjectsAt(mi.getX(), mi.getY(), null);
            Actor Enemy = list.get(0);
            if(inRange.contains(list.get(0)) && Greenfoot.mouseClicked(Enemy)) {
                getWorld().removeObject(Enemy);
            }
        }
        state = 0;
    }

    public int getHP(){
        return HP;
    }

    public void setHP(int HP){
        this.HP = HP;
    }

    public int getDmg(){
        return dmg;
    }

    public void setDmg(int dmg){
        this.dmg = dmg;
    }

    public int getCost(){
        return cost;
    }

    public boolean getIsPlayer() {
        return isPlayer;
    }
}
